<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Prepare miRNA-augmented pathways for integrative miRNA-mRNA pathway analyses — preparePathways • MIRit</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Prepare miRNA-augmented pathways for integrative miRNA-mRNA pathway analyses — preparePathways"><meta property="og:description" content="This function takes influential miRNA-mRNA interactions, identified by the
mirnaIntegration() function, and adds them to biological pathways
retrieved from a pathway database such as KEGG, WikiPathways and
Reactome. The pathways returned from this function are needed to perform
a topologically-aware integrative pathway analysis (TAIPA) through the
topologicalAnalysis() function."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MIRit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/MIRit.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jacopo-ronchi/MIRit/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Prepare miRNA-augmented pathways for integrative miRNA-mRNA pathway analyses</h1>
    <small class="dont-index">Source: <a href="https://github.com/jacopo-ronchi/MIRit/blob/HEAD/R/topological-integration.R" class="external-link"><code>R/topological-integration.R</code></a></small>
    <div class="hidden name"><code>preparePathways.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function takes influential miRNA-mRNA interactions, identified by the
<code><a href="mirnaIntegration.html">mirnaIntegration()</a></code> function, and adds them to biological pathways
retrieved from a pathway database such as <code>KEGG</code>, <code>WikiPathways</code> and
<code>Reactome</code>. The pathways returned from this function are needed to perform
a topologically-aware integrative pathway analysis (TAIPA) through the
<code><a href="topologicalAnalysis.html">topologicalAnalysis()</a></code> function.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">preparePathways</span><span class="op">(</span></span>
<span>  <span class="va">mirnaObj</span>,</span>
<span>  database <span class="op">=</span> <span class="st">"KEGG"</span>,</span>
<span>  organism <span class="op">=</span> <span class="st">"Homo sapiens"</span>,</span>
<span>  minPc <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="fu">bpparam</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mirnaObj</dt>
<dd><p>A <code><a href="MirnaExperiment-class.html">MirnaExperiment</a></code> object
containing miRNA and gene data</p></dd>


<dt>database</dt>
<dd><p>The name of the database to use. It must be one of: <code>KEGG</code>,
<code>Reactome</code>, and <code>WikiPathways</code>. Default is <code>KEGG</code></p></dd>


<dt>organism</dt>
<dd><p>The name of the organism under consideration. The different
databases have different supported organisms. To see the list of supported
organisms for a given database, use the <code><a href="supportedOrganisms.html">supportedOrganisms()</a></code> function.
Default specie is <code>Homo sapiens</code></p></dd>


<dt>minPc</dt>
<dd><p>The minimum percentage of measured features that a pathway must
have for being considered in the analysis. Default is 10. See the <em>details</em>
section for additional information</p></dd>


<dt>BPPARAM</dt>
<dd><p>The desired parallel computing behavior. This parameter
defaults to <code><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">BiocParallel::bpparam()</a></code>, but this can be edited. See
<code><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">BiocParallel::bpparam()</a></code> for information on parallel computing in R</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>list</code> object containing the miRNA-augmented pathways as <code>graphNEL</code></p>


<p>objects.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>To create augmented pathways, this function uses the <code>graphite</code> R package
to download biological networks from the above mentioned databases. Then,
each pathway is converted to a <code>graph</code> object, and significant miRNA-mRNA
interactions are added to the network. Further, edge weights are added
according to interaction type.</p>
<p>At this point, biological pathways with few nodes measured are excluded
from this analysis. This is required because, during differential expression
analysis, lowly expressed features are removed. Therefore, some pathways
might result significantly affected even if only 1% of nodes is perturbed.
The default behavior is to exclude pathways with less than 10% of
representation (<code>minPc = 10</code>).</p>
<p>Finally, this function performs a breadth-first search (BFS) algorithm to
topologically sort pathway nodes so that each individual node occurs after
all its upstream nodes. Nodes within cycles are considered leaf nodes.</p>
<p>Information about pathway coverage, i.e. the percentage of nodes with
expression measurments, edge weights, topological sorting order, and the
parameters used to create the networks are all stored in the <code>graphData</code>
slot of each <code>graphNEL</code> object.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Sales, G., Calura, E., Cavalieri, D. et al. graphite - a Bioconductor
package to convert pathway topology to gene network.
BMC Bioinformatics 13, 20 (2012),
<a href="https://doi.org/10.1186/1471-2105-13-20" class="external-link">https://doi.org/10.1186/1471-2105-13-20</a>.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Jacopo Ronchi, <a href="mailto:jacopo.ronchi@unimib.it">jacopo.ronchi@unimib.it</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># load example MirnaExperiment object</span></span></span>
<span class="r-in"><span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="loadExamples.html">loadExamples</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># perform integration analysis with default settings</span></span></span>
<span class="r-in"><span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirnaIntegration.html">mirnaIntegration</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Since data derive from paired samples, a correlation test will be used.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Performing Spearman's correlation analysis...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> A statistically significant correlation between 215 miRNA-target pairs was found!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># retrieve pathways from KEGG and augment them with miRNA-gene interactions</span></span></span>
<span class="r-in"><span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu">preparePathways</span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Downloading pathways from KEGG database...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converting identifiers to gene symbols...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding miRNA-gene interactions to biological pathways...</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>152 pathways have been ignored because they contain too few nodes with gene expression measurement.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Performing topological sorting of pathway nodes...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># perform the integrative pathway analysis with 1000 permutations</span></span></span>
<span class="r-in"><span><span class="va">ipa</span> <span class="op">&lt;-</span> <span class="fu"><a href="topologicalAnalysis.html">topologicalAnalysis</a></span><span class="op">(</span><span class="va">obj</span>, <span class="va">paths</span>, nPerm <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating pathway scores...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Generating random permutations...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating p-values with 1000 permutations...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Correcting p-values through the max-T procedure...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The topologically-aware integrative pathway analysis reported 2 significantly altered pathways!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># access the results of pathway analysis</span></span></span>
<span class="r-in"><span><span class="fu"><a href="integratedPathways.html">integratedPathways</a></span><span class="op">(</span><span class="va">ipa</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             pathway  coverage    score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Thyroid hormone synthesis Thyroid hormone synthesis 0.3469388 12.12941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Thyroid cancer                       Thyroid cancer 0.2820513 11.56291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           normalized.score       P.Val adj.P.Val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Thyroid hormone synthesis         8.101569 0.000999001     0.020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Thyroid cancer                    7.501669 0.000999001     0.038</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create a dotplot of integrated pathways</span></span></span>
<span class="r-in"><span><span class="fu"><a href="integrationDotplot.html">integrationDotplot</a></span><span class="op">(</span><span class="va">ipa</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="preparePathways-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># explore a specific biological network</span></span></span>
<span class="r-in"><span><span class="fu"><a href="visualizeNetwork.html">visualizeNetwork</a></span><span class="op">(</span><span class="va">ipa</span>, <span class="st">"Thyroid hormone synthesis"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="preparePathways-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jacopo Ronchi.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

